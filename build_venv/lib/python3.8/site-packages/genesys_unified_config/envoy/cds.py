"""This module is responsible for cds config"""
from pathlib import Path
from typing import Any, Dict
from genesys_unified_config.envoy.common import path_config_source


def eds_cluster_resource(cluster_name: str, eds_file: Path) -> Dict[str, Any]:
    """
    A function to create an endpoint discovery service cluster

    :param cluster_name: name of the envoy cluster
    :param eds_file: The endpoint discovery service file path

    :return: A dict containing the eds cluster resource
    """
    return {
        '@type': 'type.googleapis.com/envoy.config.cluster.v3.Cluster',
        'name': cluster_name,
        'connect_timeout': '5s',
        'type': 'EDS',
        'eds_cluster_config': {
            'eds_config': path_config_source(eds_file)
        }
    }


def cds(cluster_resources: [Dict[str, Any]]) -> Dict[str, Any]:
    """
    A function that generates and returns cluster discovery service file content

    :param cluster_resources: A list of cluster resources

    :return: A dict containing the cluster discovery service file content
    """
    return {
        'version_info': '0',
        'resources': cluster_resources
    }
